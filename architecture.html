<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindX ç³»ç»Ÿæ¶æ„å›¾</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }
        h1 {
            text-align: center;
            color: #1a202c;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        .mermaid {
            text-align: center;
            margin: 40px 0;
        }
        .legend {
            background: #f7fafc;
            border-radius: 12px;
            padding: 24px;
            margin-top: 40px;
        }
        .legend h3 {
            color: #2d3748;
            margin-top: 0;
            margin-bottom: 20px;
        }
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .legend-box {
            width: 40px;
            height: 24px;
            border-radius: 4px;
            flex-shrink: 0;
        }
        .legend-text {
            color: #4a5568;
            line-height: 1.4;
        }
        .section-title {
            text-align: center;
            color: #2d3748;
            margin: 40px 0 20px;
            font-size: 1.8em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  MindX ç³»ç»Ÿæ¶æ„</h1>
        <p class="subtitle">ä¸€ä¸ªå…·å¤‡æ€è€ƒèƒ½åŠ›ä¸”å¯è‡ªä¸»è¿›åŒ–çš„ AI æ™ºèƒ½åŠ©æ‰‹</p>
        
        <h2 class="section-title">ä¸€ã€æ•´ä½“æ¶æ„ï¼ˆæ•´æ´æ¶æ„ Clean Architectureï¼‰</h2>
        <div class="mermaid">
            <pre>
flowchart TB
    subgraph "è¡¨ç°å±‚ / é€‚é…å™¨å±‚ Adapters"
        direction TB
        A1[Web Dashboard<br/>React + Vite]
        A2[CLI å‘½ä»¤è¡Œ<br/>Cobra]
        A3[TUI ç»ˆç«¯ç•Œé¢<br/>Bubble Tea]
        A4[æ¶ˆæ¯ç½‘å…³ Gateway]
        A5[HTTP API æ¥å£<br/>Gin]
    end
    
    subgraph "åº”ç”¨å±‚ / ç”¨ä¾‹å±‚ Use Cases"
        direction TB
        B1[Brain ä»¿ç”Ÿå¤§è„‘]
        B2[Memory è®°å¿†ç³»ç»Ÿ]
        B3[Skills æŠ€èƒ½ç®¡ç†]
        B4[Capability èƒ½åŠ›ç®¡ç†]
        B5[Session ä¼šè¯ç®¡ç†]
        B6[Cron å®šæ—¶ä»»åŠ¡]
        B7[Embedding å‘é‡åŒ–æœåŠ¡]
        B8[Training è‡ªè®­ç»ƒæ¨¡å—]
    end
    
    subgraph "æ ¸å¿ƒå±‚ / å®ä½“å±‚ Core / Entities"
        direction TB
        C1[Thinking æ€è€ƒæ¥å£]
        C2[Brain å¤§è„‘æ¥å£]
        C3[Memory è®°å¿†æ¥å£]
        C4[Assistant åŠ©æ‰‹æ¥å£]
        C5[Channel é€šé“æ¥å£]
        C6[å®ä½“å®šä¹‰<br/>Capability/Session/Skill]
    end
    
    subgraph "åŸºç¡€è®¾æ–½å±‚ Infrastructure"
        direction TB
        D1[Bootstrap å¯åŠ¨å¼•å¯¼]
        D2[Persistence æŒä¹…åŒ–<br/>Badger KV / SQLite]
        D3[Embedding Provider<br/>Ollama / TF-IDF]
        D4[LLM Provider<br/>Ollama / OpenAI API]
        D5[Cron Scheduler<br/>Crontab / Windows Task]
        D6[Logging æ—¥å¿—ç³»ç»Ÿ<br/>Zap]
    end
    
    subgraph "å¤–éƒ¨ç³»ç»Ÿ External Systems"
        direction TB
        E1[Ollama æœ¬åœ°æ¨¡å‹]
        E2[äº‘ç«¯å¤§æ¨¡å‹<br/>GLM / Qwen / Claude]
        E3[ç¤¾äº¤å¹³å°<br/>å¾®ä¿¡/é’‰é’‰/QQ/é£ä¹¦]
        E4[Telegram / WhatsApp]
        E5[iMessage / Facebook]
    end

    A1 --> A5
    A2 --> B1
    A3 --> B1
    A4 --> B1
    A5 --> B1
    
    B1 --> C1
    B1 --> C2
    B2 --> C3
    B3 --> C6
    B4 --> C6
    B5 --> C6
    B6 --> D5
    B7 --> D3
    B8 --> E1
    
    C1 --> D4
    C3 --> D2
    C5 --> E3
    C5 --> E4
    C5 --> E5
    
    D3 --> E1
    D4 --> E1
    D4 --> E2
</pre>
        </div>
        
        <h2 class="section-title">äºŒã€ä»¿ç”Ÿå¤§è„‘æ¶æ„</h2>
        <div class="mermaid">
            <pre>
flowchart LR
    subgraph "Bionic Brain ä»¿ç”Ÿå¤§è„‘"
        direction TB
        
        subgraph "Subconscious æ½œæ„è¯†å±‚<br/>(æœ¬åœ°å¾®å‹æ¨¡å‹)"
            LB[å·¦è„‘ Left Brain<br/>- æ„å›¾è¯†åˆ«<br/>- å…³é”®è¯æå–<br/>- ç®€å•é—®ç­”<br/>æ¨¡å‹: qwen3:0.6b]
            RB[å³è„‘ Right Brain<br/>- æŠ€èƒ½è°ƒç”¨<br/>- Function Call<br/>- å·¥å…·æ‰§è¡Œ]
        end
        
        subgraph "Consciousness ä¸»æ„è¯†å±‚<br/>(äº‘ç«¯/èƒ½åŠ›æ¨¡å‹)"
            C[æ„è¯† Consciousness<br/>- æ·±åº¦æ€è€ƒ<br/>- å¤æ‚æ¨ç†<br/>- èƒ½åŠ›è°ƒç”¨]
        end
        
        subgraph "Memory System è®°å¿†ç³»ç»Ÿ"
            STM[çŸ­æœŸè®°å¿†<br/>Session History]
            LTM[é•¿æœŸè®°å¿†<br/>Vector Store]
            PM[æ°¸ä¹…è®°å¿†<br/>Fine-tuned Model]
        end
    end
    
    Input[ç”¨æˆ·è¾“å…¥] --> LB
    
    LB -->|å¯ä»¥å›ç­”?| Output1[ç›´æ¥å›ç­”]
    LB -->|éœ€è¦æŠ€èƒ½?| RB
    LB -->|æ— æ³•å›ç­”?| C
    
    RB --> Output2[æ‰§è¡ŒæŠ€èƒ½è¿”å›ç»“æœ]
    C --> Output3[æ·±åº¦æ€è€ƒè¿”å›ç»“æœ]
    
    LB <--> Memory_System
    RB <--> Memory_System
    C <--> Memory_System
    
    Memory_System <-->|è®°å¿†æå–| LB
    Memory_System <-->|è®°å¿†æå–| RB
    Memory_System <-->|è®°å¿†æå–| C
    
    Memory_System <-->|è®°å¿†æ²‰æ·€| LB
</pre>
        </div>
        
        <h2 class="section-title">ä¸‰ã€æ¶ˆæ¯å¤„ç†æµç¨‹</h2>
        <div class="mermaid">
            <pre>
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Channel as æ¶ˆæ¯é€šé“
    participant Gateway as ç½‘å…³ Gateway
    participant Brain as ä»¿ç”Ÿå¤§è„‘
    participant Memory as è®°å¿†ç³»ç»Ÿ
    participant Skills as æŠ€èƒ½ç®¡ç†å™¨
    participant CapMgr as èƒ½åŠ›ç®¡ç†å™¨
    participant Model as å¤§æ¨¡å‹
    
    User->>Channel: å‘é€æ¶ˆæ¯
    Channel->>Gateway: è½¬å‘æ¶ˆæ¯
    Gateway->>Brain: å¤„ç†è¯·æ±‚
    
    Brain->>Memory: è·å–ç›¸å…³è®°å¿†
    Memory-->>Brain: è¿”å›è®°å¿†ç‰‡æ®µ
    
    Brain->>Brain: å·¦è„‘æ€è€ƒ<br/>(æ„å›¾è¯†åˆ«/å…³é”®è¯æå–)
    
    alt å¯ä»¥ç›´æ¥å›ç­”
        Brain->>Model: æœ¬åœ°å¾®å‹æ¨¡å‹
        Model-->>Brain: è¿”å›ç­”æ¡ˆ
    else éœ€è¦æŠ€èƒ½
        Brain->>Skills: æœç´¢åŒ¹é…æŠ€èƒ½
        Skills-->>Brain: è¿”å›å·¥å…· Schema
        Brain->>Brain: å³è„‘å¤„ç†<br/>(Function Call)
        Brain->>Skills: æ‰§è¡ŒæŠ€èƒ½
        Skills-->>Brain: è¿”å›æŠ€èƒ½ç»“æœ
    else éœ€è¦æ·±åº¦æ€è€ƒ
        Brain->>CapMgr: åŒ¹é…èƒ½åŠ›
        CapMgr-->>Brain: è¿”å›èƒ½åŠ›é…ç½®
        Brain->>Brain: ä¸»æ„è¯†æ¿€æ´»
        Brain->>Model: äº‘ç«¯å¤§æ¨¡å‹
        Model-->>Brain: è¿”å›æ·±åº¦æ€è€ƒç»“æœ
    end
    
    Brain->>Memory: æ²‰æ·€æ–°è®°å¿†
    Brain-->>Gateway: è¿”å›å›ç­”
    Gateway-->>Channel: è½¬å‘å›ç­”
    Channel-->>User: æ˜¾ç¤ºå›ç­”
</pre>
        </div>
        
        <h2 class="section-title">å››ã€ç›®å½•ç»“æ„ä¸æ¨¡å—å…³ç³»</h2>
        <div class="mermaid">
            <pre>
flowchart TB
    subgraph "Root æ ¹ç›®å½•"
        cmd[cmd/main.go<br/>ç¨‹åºå…¥å£]
        config[config/<br/>é…ç½®æ–‡ä»¶ YAML]
        dashboard[dashboard/<br/>React å‰ç«¯]
        internal[internal/<br/>æ ¸å¿ƒä¸šåŠ¡]
        pkg[pkg/<br/>å…¬å…±åŒ…]
        skills[skills/<br/>æŠ€èƒ½ç›®å½•]
    end
    
    subgraph "internal æ ¸å¿ƒä¸šåŠ¡"
        adapters[adapters/<br/>é€‚é…å™¨å±‚]
        core[core/<br/>æ ¸å¿ƒå±‚]
        entity[entity/<br/>å®ä½“å®šä¹‰]
        usecase[usecase/<br/>ç”¨ä¾‹å±‚]
        infrastructure[infrastructure/<br/>åŸºç¡€è®¾æ–½]
    end
    
    subgraph "adapters é€‚é…å™¨"
        channels[channels/<br/>- é’‰é’‰/å¾®ä¿¡/QQ<br/>- é£ä¹¦/Telegram<br/>- WhatsApp/iMessage]
        cli[cli/<br/>å‘½ä»¤è¡Œå·¥å…·]
        http[http/handlers/<br/>HTTP API]
    end
    
    subgraph "usecase ç”¨ä¾‹"
        brain[brain/<br/>ä»¿ç”Ÿå¤§è„‘å®ç°]
        memory[memory/<br/>è®°å¿†ç³»ç»Ÿ]
        skills_uc[skills/<br/>æŠ€èƒ½ç®¡ç†]
        capability[capability/<br/>èƒ½åŠ›ç®¡ç†]
        session[session/<br/>ä¼šè¯ç®¡ç†]
        cron_uc[cron/<br/>å®šæ—¶ä»»åŠ¡]
        training[training/<br/>è‡ªè®­ç»ƒ]
    end
    
    subgraph "infrastructure åŸºç¡€è®¾æ–½"
        bootstrap[bootstrap/<br/>å¯åŠ¨å¼•å¯¼]
        persistence[persistence/<br/>- Badger KV<br/>- SQLite]
        embedding[embedding/<br/>- Ollama<br/>- TF-IDF]
        llama[llama/<br/>Ollama é›†æˆ]
    end
    
    cmd --> bootstrap
    bootstrap --> brain
    bootstrap --> memory
    bootstrap --> skills_uc
    bootstrap --> capability
    bootstrap --> session
    bootstrap --> cron_uc
    
    brain --> core
    memory --> core
    skills_uc --> core
    capability --> core
    
    channels --> brain
    http --> brain
    cli --> brain
    
    persistence --> memory
    embedding --> skills_uc
    llama --> brain
</pre>
        </div>
        
        <div class="legend">
            <h3>ğŸ“‹ æ¶æ„å…³é”®ç‰¹æ€§è¯´æ˜</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-box" style="background: #93c5fd;"></div>
                    <div class="legend-text">
                        <strong>è¡¨ç°å±‚</strong><br/>Webã€CLIã€TUIã€å¤šæ¸ é“æ¶ˆæ¯æ¥å…¥
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #86efac;"></div>
                    <div class="legend-text">
                        <strong>åº”ç”¨å±‚</strong><br/>ä»¿ç”Ÿå¤§è„‘ã€è®°å¿†ã€æŠ€èƒ½ã€èƒ½åŠ›ã€ä¼šè¯ç®¡ç†
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #fde047;"></div>
                    <div class="legend-text">
                        <strong>æ ¸å¿ƒå±‚</strong><br/>æ¥å£å®šä¹‰ã€å®ä½“ã€ä¸šåŠ¡è§„åˆ™
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #fca5a5;"></div>
                    <div class="legend-text">
                        <strong>åŸºç¡€è®¾æ–½å±‚</strong><br/>æŒä¹…åŒ–ã€æ¨¡å‹é›†æˆã€æ—¥å¿—ã€è°ƒåº¦
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #c4b5fd;"></div>
                    <div class="legend-text">
                        <strong>å·¦è„‘</strong><br/>æœ¬åœ°å¾®å‹æ¨¡å‹ï¼Œå¿«é€Ÿå¤„ç†ç®€å•ä»»åŠ¡
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #f9a8d4;"></div>
                    <div class="legend-text">
                        <strong>å³è„‘</strong><br/>æŠ€èƒ½è°ƒç”¨ã€Function Call æ‰§è¡Œ
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #67e8f9;"></div>
                    <div class="legend-text">
                        <strong>ä¸»æ„è¯†</strong><br/>æ·±åº¦æ€è€ƒã€å¤æ‚æ¨ç†ã€äº‘ç«¯æ¨¡å‹
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-box" style="background: #bef264;"></div>
                    <div class="legend-text">
                        <strong>è®°å¿†ç³»ç»Ÿ</strong><br/>çŸ­æœŸ/é•¿æœŸ/æ°¸ä¹…è®°å¿†ä¸‰å±‚ç»“æ„
                    </div>
                </div>
            </div>
        </div>
        
        <div class="legend" style="margin-top: 24px;">
            <h3>ğŸ›  æŠ€æœ¯æ ˆ</h3>
            <div class="legend-grid">
                <div class="legend-text">
                    <strong>åç«¯</strong><br/>Go 1.25+ã€Ginã€Cobraã€Bubble Tea
                </div>
                <div class="legend-text">
                    <strong>å‰ç«¯</strong><br/>Reactã€Viteã€Tailwind CSS
                </div>
                <div class="legend-text">
                    <strong>æ•°æ®åº“</strong><br/>Badger KVã€SQLite
                </div>
                <div class="legend-text">
                    <strong>æ¨¡å‹</strong><br/>Ollamaã€OpenAI APIã€GLMã€Qwen
                </div>
                <div class="legend-text">
                    <strong>æ—¥å¿—</strong><br/>Zapã€Lumberjack
                </div>
                <div class="legend-text">
                    <strong>é…ç½®</strong><br/>Viperã€YAML
                </div>
            </div>
        </div>
    </div>
    
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                showSequenceNumbers: false,
                wrap: true,
                width: 150
            }
        });
    </script>
</body>
</html>
